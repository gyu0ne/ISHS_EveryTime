{% extends "base.html" %}

{% block title %}log인곽 - 마이페이지{% endblock %}

{% block head %}
    <script src="{{ url_for('static', filename='js/my_page.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/my_page.css') }}">
{% endblock %}

{% block content %}
    <div class="mypage-container">
        <main class="content-wrapper">
            <aside class="profile-sidebar">
                <div class="card profile-card">
                    <div class="profile-picture">
                        <img src="{{ url_for('static', filename=profile_image) }}" alt="프로필 사진">
                        <button class="change-pic-btn">변경</button>
                    </div>
                    <h2 class="nickname">{{ nickname }}</h2>
                    <div class="level-info">
                        <span>Lv. {{ level }}</span>
                        <div class="exp-bar">
                            <div class="exp-gauge" style="width: 75%;"></div>
                        </div>
                        <span class="exp-text">{{ exp }} / 1000 EXP</span>
                    </div>
                    <div class="point-info">
                        <p>캐시: <span>{{ point }} P</span></p>
                    </div>
                    <div class="stats-info">
                        <div>
                            <p class="stat-title">게시글</p>
                            <p class="stat-count">{{ post_count }}</p>
                        </div>
                        <div>
                            <p class="stat-title">댓글</p>
                            <p class="stat-count">{{ comment_count }}</p>
                        </div>
                    </div>
                </div>

                <div class="card user-details">
                    <h3>개인 정보</h3>
                    <ul>
                        <li><span>이름</span><strong>{{ name }}</strong></li>
                        <li><span>학번</span><strong>{{ hakbun }}</strong></li>
                        <li><span>기수</span><strong>{{ gen }}기</strong></li>
                        <li><span>생년월일</span><strong>{{ birth }}</strong></li>
                        <li><span>가입일자</span><strong>{{ join_date }}</strong></li>
                    </ul>
                </div>
                
                <div class="card account-management">
                    <h3>계정 관리</h3>
                    <button class="btn">비밀번호 변경</button>
                    <button class="btn">로그아웃</button>
                    <button class="btn btn-delete">계정 삭제</button>
                </div>
            </aside>

            <section class="activity-content">
                <nav class="activity-tabs">
                    <ul>
                        <li><a href="#" id="posts-tab" class="active">작성 게시글</a></li>
                        <li><a href="#" id="comments-tab">작성 댓글</a></li>
                    </ul>
                </nav>

                <div id="posts-list" class="activity-list">
                    <ul>
                        {% if user_posts %}
                            {% for post in user_posts %}
                            <li>
                                <div class="post-info">
                                    <a href="{{ url_for('post_detail', post_id=post.id) }}" class="post-title">{{ post.title }}</a>
                                    <p class="post-meta">{{ post.board_name }} ・ {{ post.updated_at|datetime }}</p>
                                </div>
                                <div class="post-stats">
                                    <span>댓글 {{ post.comment_count }}</span>
                                </div>
                            </li>
                            {% endfor %}
                        {% else %}
                            <li class="no-posts-message">작성한 게시글이 없습니다.</li>
                        {% endif %}
                    </ul>
                </div>

                <div id="comments-list" class="activity-list" style="display: none;"> <ul>
                        {% if user_comments %}
                            {% for comment in user_comments %}
                            <li>
                                <div class="post-info">
                                    <p class="comment-content">{{ comment.content }}</p>
                                    <a href="{{ url_for('post_detail', post_id=comment.post_id) }}" class="post-meta">
                                        원본 글: {{ comment.post_title }} ・ {{ comment.updated_at }}
                                    </a>
                                </div>
                            </li>
                            {% endfor %}
                        {% else %}
                            <li class="no-posts-message">작성한 댓글이 없습니다.</li>
                        {% endif %}
                    </ul>
                </div>
            </section>
        </main>
    </div>
{% endblock %}